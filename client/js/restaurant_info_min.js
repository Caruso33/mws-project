var restaurant,map;window.initMap=function(){fetchRestaurantFromURL(function(a,b){a?console.error(a):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:b.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})};
var fetchRestaurantFromURL=function(a){if(self.restaurant)a(null,self.restaurant);else{var b=getParameterByName("id");b?DBHelper.fetchRestaurantById(b,function(c,b){(self.restaurant=b)?(fillRestaurantHTML(),a(null,b)):console.error(c)}):(error="No restaurant id in URL",a(error,null))}},fillRestaurantHTML=function(a){a=void 0===a?self.restaurant:a;document.getElementById("restaurant-name").innerHTML=a.name;document.getElementById("restaurant-address").innerHTML=a.address;var b=document.getElementById("restaurant-img"),
c=document.getElementById("restaurant-figcap");b.className="restaurant-img";b.src=DBHelper.imageUrlForRestaurant(a);b.alt="An impression of restaurant "+a.name;c.innerHTML="Restaurant "+a.name;c=b.src.slice(0,-17);b.srcset=c+"-250_small-min.webp 250w,\n                  "+c+"-400_medium-min.webp 400w,\n                  "+c+"-600_large-min.webp 600w,\n                  "+c+"-800_orig-min.webp 800w\n                  ";b.sizes="90vw";document.getElementById("restaurant-cuisine").innerHTML=a.cuisine_type;
a.operating_hours&&fillRestaurantHoursHTML();fillReviewsHTML()},fillRestaurantHoursHTML=function(a){a=void 0===a?self.restaurant.operating_hours:a;var b=document.getElementById("restaurant-hours"),c;for(c in a){var d=document.createElement("tr"),e=document.createElement("td");e.innerHTML=c;d.appendChild(e);e=document.createElement("td");e.innerHTML=a[c];d.appendChild(e);b.appendChild(d)}},fillReviewsHTML=function(a){a=void 0===a?self.restaurant.reviews:a;var b=document.getElementById("reviews-container"),
c=document.createElement("h2");c.innerHTML="Reviews";b.appendChild(c);if(a){var d=document.getElementById("reviews-list");a.forEach(function(a){d.appendChild(createReviewHTML(a))});b.appendChild(d)}else a=document.createElement("p"),a.innerHTML="No reviews yet!",b.appendChild(a)},createReviewHTML=function(a){var b=document.createElement("li"),c=document.createElement("p");c.innerHTML=a.name;c.classList.add("review-author");var d=document.createElement("span");d.innerHTML=a.date;d.classList.add("review-date");
c.appendChild(d);b.appendChild(c);c=document.createElement("p");c.innerHTML="Rating: "+a.rating;c.classList.add("review-rating");b.appendChild(c);c=document.createElement("p");c.innerHTML=a.comments;c.classList.add("review-comments");b.appendChild(c);return b},fillBreadcrumb=function(a){a=void 0===a?self.restaurant:a;var b=document.getElementById("breadcrumb");if(4>b.childNodes.length){var c=document.createElement("li");c.innerHTML=a.name;b.appendChild(c)}},getParameterByName=function(a,b){b||(b=
window.location.href);a=a.replace(/[\[\]]/g,"\\$&");return(a=(new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)")).exec(b))?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null};
